services:
  backend-prd:
    build:
      context: src/backend
      dockerfile: ../../container/backend.dockerfile
    ports:
      - "8080:8080"
    environment:
      - env=prd
      - R2_ACCOUNT_ID=${R2_ACCOUNT_ID}
      - R2_ACCESS_KEY_ID=${R2_ACCESS_KEY_ID}
      - R2_SECRET_ACCESS_KEY=${R2_SECRET_ACCESS_KEY}
    volumes:
      - backend-data:/app/data

  frontend-prd:
    build:
      context: src/frontend
      dockerfile: ../../container/frontend.dockerfile
    ports:
      - "80:3000"
    environment:
      - BACKEND_URL=http://backend-prd:8080
    depends_on:
      - backend-prd

volumes:
  backend-data:
